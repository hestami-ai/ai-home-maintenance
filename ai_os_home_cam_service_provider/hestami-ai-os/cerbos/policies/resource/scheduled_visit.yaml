apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: default
  resource: scheduled_visit
  importDerivedRoles:
    - common_roles
  rules:
    - actions: ["view", "create", "edit", "delete", "confirm", "start", "complete", "cancel", "reschedule"]
      effect: EFFECT_ALLOW
      roles: ["admin"]
    - actions: ["view", "create", "edit", "delete", "confirm", "start", "complete", "cancel", "reschedule"]
      effect: EFFECT_ALLOW
      derivedRoles: ["org_admin", "org_manager"]
      condition:
        match:
          expr: request.resource.attr.organizationId == request.principal.attr.organizationId
    - actions: ["view", "start", "complete"]
      effect: EFFECT_ALLOW
      derivedRoles:
        - org_vendor
        - org_stakeholder
      condition:
        match:
          expr: request.resource.attr.organizationId == request.principal.attr.organizationId
