apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: default
  resource: purchase_order
  importDerivedRoles:
    - common_roles
  rules:
    - actions: ["view", "create", "edit", "submit", "confirm", "receive", "cancel", "delete"]
      effect: EFFECT_ALLOW
      roles: ["admin"]
    - actions: ["view", "create", "edit", "submit", "confirm", "receive", "cancel", "delete"]
      effect: EFFECT_ALLOW
      derivedRoles: ["org_admin", "org_manager"]
      condition:
        match:
          expr: request.resource.attr.organizationId == request.principal.attr.organizationId
    - actions: ["view", "create"]
      effect: EFFECT_ALLOW
      derivedRoles:
        - org_vendor
        - org_stakeholder
      condition:
        match:
          expr: request.resource.attr.organizationId == request.principal.attr.organizationId
